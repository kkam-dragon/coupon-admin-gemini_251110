# 📘 COUFUN B2C 연동 매뉴얼 – 쿠폰생성 (Ver. 1.4)

**작성자:** ㈜티사이언티픽  
**최종 개정일:** 2020.08.26  
**문서 버전:** 1.4  

---

## 🕓 개정 이력

| 버전 | 개정일자 | 개정 내역 | 작성/개정자 | 확인자 |
|:----:|:----------|:-----------|:-------------|:--------|
| 1.0 | 2012-01-03 | 초안 작성 | 정철 | - |
| 1.1 | 2013-12-09 | 쿠폰 자리수 변경 | 정철 | - |
| 1.2 | 2018-07-11 | 상용 URL 프로토콜 변경 | 송도화 | - |
| 1.3 | 2020-07-14 | 인지세 문구 추가 | 김경수 | - |
| 1.4 | 2020-08-26 | 사명 변경 | 송도화 | - |

---

## 1️⃣ 개요

본 문서는 **㈜티사이언티픽의 모바일커머스 시스템과 연동에 필요한 쿠폰 생성 절차**를 기술한 문서이다.

### 🧭 Service Flow

Client → Server 요청 → 쿠폰 발행 → 결과 리턴  

---

## 2️⃣ 시스템 정보

### ✅ 쿠폰 생성 URL

| 구분 | URL | 비고 |
|:----|:----|:----|
| **상용 URL** | `https://corp.coufun.kr:446/b2c_api/coufunCreate.do` | - |
| **테스트 URL** | `https://tcorp.coufun.kr:446/b2c_api/coufunCreate.do` | - |

### ⚙️ 연동정보

- **HTTP POST 방식 호출**
- **XML 형식의 결과값 리턴**

### ⚠️ 유의사항

1. 반드시 **테스트 서버를 통해 연동 구현 후 상용 서버에 적용**  
2. **IP 등록이 필요하며, 미등록 시 사전 요청 필요**  

---

## 3️⃣ 연동 인터페이스

### 📄 정의

클라이언트의 쿠폰 발급 요청 데이터를 이용해 **시스템이 쿠폰 발행 후 결과를 XML로 리턴**한다.

### 🌐 연동 URL (테스트용)

```
https://tcorp.coufun.kr:446/b2c_api/coufunCreate.do?Parameter
```

---

## 4️⃣ 요청 파라미터

| 변수명 | 설명 | 최대길이 | 체크 |
|:------|:------|:----------|:------|
| `POC_ID` | 고객사 ID | 10byte | 필수 |
| `GOODS_ID` | 판매상품 ID | 10byte | 필수 |
| `CREATE_CNT` | 쿠폰 생성 개수 (최대 10개) | Number | 필수 |
| `TR_ID` | 고객사 고유 ID (고객사 식별키) | 50byte | 선택 |
| `RESERVE1` | 추가 입력 필드 1 | 500byte | 선택 |
| `RESERVE2` | 추가 입력 필드 2 | 500byte | 선택 |

> **참고:**  
> `TR_ID`는 고객사 측 발송요청 후 결과 데이터를 구분하기 위한 용도로 활용됨.

---

## 5️⃣ 응답 파라미터

| 변수명 | 설명 | 최대길이 |
|:------|:------|:----------|
| `RESULT_CODE` | 실행 결과 코드 | 2byte |
| `RESULT_MSG` | 실행 결과 메시지 | 100byte |
| `ORDER_ID` | 주문 ID | 30byte |
| `CAT_ID` | 카테고리 ID | 10byte |
| `GOODS_ID` | 판매상품 ID | 10byte |
| `TR_ID` | 고객사 고유 ID | 50byte |
| `ORDER_CNT` | 수량 | Number |
| `VALID_END_DATE` | 상품 유효기간 (YYYYMMDD) | 8byte |
| `BARCODE_NUM` | 쿠폰번호 | 30byte |
| `STAMP_DUTY` | 인지세 문구 | 100byte |
| `RESERVE1` | 추가 필드 1 | 500byte |
| `RESERVE2` | 추가 필드 2 | 500byte |

---

## 6️⃣ 응답 예시

### ✅ 성공 시
```xml
<?xml version="1.0" encoding="EUC-KR"?>
<COUFUNCREATE>
  <RESULT_CODE>00</RESULT_CODE>
  <RESULT_MSG>SUCCESS</RESULT_MSG>
  <ORDER_ID>ORDER20200826</ORDER_ID>
  <CAT_ID>CAT001</CAT_ID>
  <GOODS_ID>GOOD001</GOODS_ID>
  <TR_ID>CLIENT123</TR_ID>
  <ORDER_CNT>3</ORDER_CNT>
  <VALID_END_DATE>20201231</VALID_END_DATE>
  <RESERVE1>추가정보1</RESERVE1>
  <RESERVE2>추가정보2</RESERVE2>
  <ORDER_INFO>
    <BARCODE_NUM>ABC1234567890</BARCODE_NUM>
    <STAMP_DUTY>인지세 없음</STAMP_DUTY>
  </ORDER_INFO>
</COUFUNCREATE>
```

> 여러 건인 경우 `<ORDER_INFO>` 블록이 생성된 쿠폰 개수만큼 반복됨 (최대 10건).

### ❌ 실패 시
```xml
<?xml version="1.0" encoding="EUC-KR"?>
<COUFUNCREATE>
  <RESULT_CODE>99</RESULT_CODE>
  <RESULT_MSG>ERROR MESSAGE</RESULT_MSG>
</COUFUNCREATE>
```

---

## 7️⃣ 결과 코드 명세

별도 문서 참조:  
**`COUFUN_B2C_연동규격서_결과코드명세.pdf`**

---

## 8️⃣ 문의처

- **담당부서:** 전산운영팀  
- **이메일:** [devops@tscientific.co.kr](mailto:devops@tscientific.co.kr)
