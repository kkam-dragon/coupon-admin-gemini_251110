# π“ λ°μ†΅ ν›„ λ°μ†΅ κ²°κ³Ό ν™•μΈλ°©λ²• (UMS_MSG / UMS_LOG κΈ°μ¤€)

**μ¶μ²:** [MessageHub Agent Notion λ¬Έμ„](https://msghub-agent.notion.site/b395fc33f6e5476c92a4c2759364137d)  
**μ‘μ„±μΌ:** 2025-10-17  

---

## π§­ κ°μ”

μ΄ λ¬Έμ„λ” **λ°μ†΅μ΄ μ™„λ£λ ν›„ μ΄λ ¥ν…μ΄λΈ”(UMS_LOG_YYYYMM λ“±)μ DONE_ μ»¬λΌμ„ ν†µν•΄ κ²°κ³Όλ¥Ό ν™•μΈν•λ” λ°©λ²•**μ„ μ•λ‚΄ν•©λ‹λ‹¤.  
λ©”μ‹μ§€ν—λΈ μ—μ΄μ „νΈκ°€ κ²°κ³Όλ¥Ό μμ‹ ν• λ’¤, DBμ κ²°κ³Ό μ»¬λΌμ„ μ—…λ°μ΄νΈ λ° μ΄κ΄€ν•λ” κ³Όμ •μ„ ν¬ν•¨ν•©λ‹λ‹¤.

---

## π“‘ λ©μ°¨

1. μ΄λ ¥ν…μ΄λΈ”μ κ²°κ³Ό μ»¬λΌ  
2. λ°μ†΅ μ„±κ³µ μƒν’ ν™•μΈν•κΈ°  
3. μƒμ„Έ κ²°κ³Ό ν™•μΈν•λ” λ°©λ²•  
γ€€γ€€1) λ°μ†΅ μ„±κ³µ  
γ€€γ€€2) λ°μ†΅ μ‹¤ν¨  
4. κ²°κ³Ό μ½”λ“ ν™•μΈν•κΈ°

---

## 1οΈβƒ£ μ΄λ ¥ν…μ΄λΈ”μ κ²°κ³Ό μ»¬λΌ

λ°μ†΅μ΄ μ™„λ£λλ©΄ **μ—μ΄μ „νΈκ°€ κ²°κ³Όλ¥Ό μμ‹ ν•μ—¬ μ—…λ°μ΄νΈ ν›„ μ΄κ΄€**ν•©λ‹λ‹¤.  
μ΄ λ• κ²°κ³Όλ¥Ό ν™•μΈν•  μ μλ” μ£Όμ” μ»¬λΌμ€ μ•„λμ™€ κ°™μµλ‹λ‹¤.

| μ»¬λΌλ… | μ„¤λ… |
|:--------|:------|
| **ROUTE_INFO** | μ‹¤μ  μ΄λ―Έμ§€λ¥Ό λ°μ†΅ν• API KEY |
| **SENT_DATE** | μ‹¤μ λ΅ ν—λΈ μ—μ΄μ „νΈκ°€ λ©”μ‹μ§€ν—λΈ G/Wλ΅ λ°μ†΅ν• μ‹κ°„ |
| **DONE_CH** | μ‹¤μ  λ°μ†΅λ μ±„λ„ λ… (SMS/MMS/RCS/ALIMTALK/FRIENDTALK) |
| **DONE_PRODUCT** | μ‹¤μ  λ°μ†΅μ„ μ„±κ³µν• μƒν’ μΆ…λ¥ |
| **DONE_DATE** | λ‹¨λ§μ— μ „λ‹¬λ μ‹κ°„ λλ” μ‹¤ν¨λ μµμΆ… μ‹κ°„ |
| **DONE_CODE** | μ²λ¦¬λ κ²°κ³Ό μ½”λ“ |
| **DONE_CODE_DESC** | μ²λ¦¬λ κ²°κ³Ό μƒμ„Έ λ‚΄μ© |
| **DONE_FB_DETAIL** | μ²μ μ”μ²­ν• μ±„λ„μ—μ„ μ‹¤ν¨ ν›„ λ‹¤μ μ±„λ„λ΅ λ°μ†΅ μ‹, μ‹¤ν¨ν• μ±„λ„μ μ½”λ“/μ‚¬μ /μ΄ν†µμ‚¬ μ •λ³΄ |
| **DONE_TELCO** | λ°μ†΅ μ™„λ£λ λ‹¨λ§μ μ΄ν†µμ‚¬ μ½”λ“ |

---

## 2οΈβƒ£ λ°μ†΅ μ„±κ³µ μƒν’ ν™•μΈν•κΈ°

μ—¬λ¬ μ±„λ„λ΅ κµ¬μ„±λ ν…ν”λ¦Ώμ„ ν†µν•΄ λ°μ†΅ν• ν›„, **`DONE_PRODUCT`** μ»¬λΌμ—λ” μ‹¤μ λ΅ λ°μ†΅ μ„±κ³µλ μƒν’ μ½”λ“κ°€ μ €μ¥λ©λ‹λ‹¤.  
κ° μ½”λ“μ μλ―Έλ” μ•„λμ™€ κ°™μµλ‹λ‹¤.

| μ±„λ„ | μ½”λ“ | μ„¤λ… |
|:------|:------|:------|
| λ¬Έμ | SMS | μΌλ° SMS |
|  | LMS | μΌλ° LMS |
|  | MMS | μΌλ° MMS |
| μΉ΄μΉ΄μ¤ν†΅ | KALT1 | μ•λ¦Όν†΅ TEXT |
|  | KALT2 | μ•λ¦Όν†΅ μ΄λ―Έμ§€ |
|  | KFRT1 | μΉκµ¬ν†΅ TEXT |
|  | KFRT2 | μΉκµ¬ν†΅ μ΄λ―Έμ§€ |
|  | KFRT3 | μΉκµ¬ν†΅ μ™€μ΄λ“ |
| RCS | RSMS | RCS SMS |
|  | RLMS | RCS LMS |
|  | RMMS | RCS MMS (μΊλ΅μ…€ μ΄λ―Έμ§€ ν¬ν•¨) |
|  | RTPLS | RCS ν…ν”λ¦Ών• (μΉμΈ/λ―ΈμΉμΈν• λ“±) |
| PUSH | PUSH | ν‘Έμ‹ λ©”μ‹μ§€ |
| μμ‹ (MO) | SMSMO | SMS μμ‹  |
|  | LMSMO | LMS μμ‹  |
|  | MMSMO | MMS μμ‹  |
| κµ­μ λ¬Έμ | GDS | κµ­μ  κ³µν†µ SMS |

---

## 3οΈβƒ£ μƒμ„Έ κ²°κ³Ό ν™•μΈν•λ” λ°©λ²•

μ‚¬μ§„μ„ ν΄λ¦­ν•λ©΄ ν™•λ€ν•μ—¬ ν™•μΈν•  μ μμµλ‹λ‹¤.  
λ‹¤μμ€ μ‹¤μ  λ°μ†΅ ν›„μ μƒνƒλ³„ κ²°κ³Ό μμ‹μ…λ‹λ‹¤.

---

### β… 1) λ°μ†΅ μ„±κ³µ

#### (1) μ²« λ²μ§Έ μ±„λ„λ΅ λ°”λ΅ μ„±κ³µν• κ²½μ°

- `DONE_CODE` λ° `DONE_CODE_DESC` μ»¬λΌμ€ **μ„±κ³µ κ°’**μΌλ΅ ν‘μ‹λ©λ‹λ‹¤.  
- `DONE_FB_DETAIL`μ€ **NULL**μ…λ‹λ‹¤.  
- μ„±κ³µν• μƒν’μ€ `RMMS` (μ¦‰, **RCS MMS**)λ΅ ν™•μΈλ©λ‹λ‹¤.

#### (2) μ²« λ²μ§Έ μ±„λ„μ€ μ‹¤ν¨ν–μΌλ‚ λ‹¤μ μ±„λ„μ—μ„ μ„±κ³µν• κ²½μ°

- `DONE_CODE` / `DONE_CODE_DESC`λ” μ„±κ³µμΌλ΅ ν‘μ‹λμ§€λ§,  
  `DONE_FB_DETAIL`μ—λ” **μ΄μ „ μ±„λ„μ μ‹¤ν¨ μ •λ³΄**κ°€ JSON ν•νƒλ΅ κΈ°λ΅λ©λ‹λ‹¤.
- μμ‹:
  - μ²« λ²μ§Έ μ±„λ„(RCS) μ‹¤ν¨ β†’ λ‘ λ²μ§Έ μ±„λ„(μΉκµ¬ν†΅) μ„±κ³µ
  - λλ” μ²« λ²μ§Έ(RCS), λ‘ λ²μ§Έ(μΉκµ¬ν†΅) λ¨λ‘ μ‹¤ν¨ ν›„ **μ„Έ λ²μ§Έ(MMS) μ„±κ³µ**

- `DONE_TELCO`μ—λ” **μμ‹ μμ μ΄ν†µμ‚¬ μ½”λ“**κ°€ μ €μ¥λ©λ‹λ‹¤.

##### π” μμ‹ JSON (3λ² λ μ½”λ“)
```json
[
  {
    "ch": "RCS",
    "fbResultCode": "54003",
    "fbResultDesc": "Unable Sending to Recipient", 
    "telco": "LGU"
  },
  {
    "ch": "FRIENDTALK",
    "fbResultCode": "32120",
    "fbResultDesc": "λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•  μ μ—†μ", 
    "telco": null
  }
]
```
> μ„ μμ‹λ” RCS μμ‹ λ¶κ°€ λ‹¨λ§ + μΉκµ¬ν†΅ μΉκµ¬μ¶”κ°€ λ¶κ°€λ΅ μΈν•΄ μµμΆ… MMSλ΅ μ„±κ³µν• μΌ€μ΄μ¤μ…λ‹λ‹¤.

---

### β 2) λ°μ†΅ μ‹¤ν¨

#### (1) λ§μ§€λ§‰ μ±„λ„κΉμ§€ λ¨λ‘ μ‹λ„ν–μΌλ‚ μ‹¤ν¨ν• κ²½μ°

- μ²« λ²μ§Έ μ±„λ„(RCS) λ°μ†΅ μ‹¤ν¨ β†’ λ‘ λ²μ§Έ μ±„λ„(μΉκµ¬ν†΅)κΉμ§€ μ‹¤ν¨  
- μ²« λ²μ§Έ μ±„λ„μ μ‹¤ν¨ λ‚΄μ©μ€ `DONE_FB_DETAIL`μ— κΈ°λ΅λ©λ‹λ‹¤.  
- **λ§μ§€λ§‰ μ‹¤ν¨ν• μ±„λ„μ μ½”λ“ λ° μ‚¬μ λ” `DONE_CODE`, `DONE_CODE_DESC`μ—μ„ ν™•μΈ κ°€λ¥**  
- `DONE_PRODUCT`λ” NULLμ…λ‹λ‹¤.

#### (2) μ—μ΄μ „νΈ μμ²΄ μ‹¤ν¨ or ν—λΈ G/Wμ—μ„ μ‹¤ν¨ν• κ²½μ°

- ν…ν”λ¦Ώ μ„¤μ •μ΄ λμ–΄ μμμ—λ„ `DONE_FB_DETAIL`μ΄ **NULL**μ΄λ©΄μ„ `DONE_CODE`κ°€ μ‹¤ν¨ μ½”λ“μΌ κ²½μ°,
  μ΄λ” **μ—μ΄μ „νΈ λ‚΄λ¶€ μ‹¤ν¨** λλ” **ν—λΈ G/W μ‹¤ν¨**μ…λ‹λ‹¤.

| κµ¬λ¶„ | μ½”λ“ λ²”μ„ | μ„¤λ… |
|:------|:------|:------|
| μ—μ΄μ „νΈ μμ²΄ μ‹¤ν¨ | 90000λ²λ€ | λ‚΄λ¶€ μ¤λ¥λ΅ μΈν• μ‹¤ν¨ |
| ν—λΈ G/W μ‹¤ν¨ | 21000~25000, 29000λ²λ€ | λ©”μ‹μ§€ν—λΈ κ²μ΄νΈμ›¨μ΄ μ¤λ¥ |

π“ **μμ‹:**  
- ν…ν”λ¦Ώμ΄ μΉκµ¬ν†΅ β†’ RCS β†’ MMS μμ„λ΅ μ„¤μ •λμ–΄ μμ–΄λ„,  
  MMSμ—μ„ PNGνμΌμ„ ν—μ©ν•μ§€ μ•μΌλ©΄ **μ΄κΈ°λ¶€ν„° μ‹¤ν¨ μ²λ¦¬**λ©λ‹λ‹¤.  
- μ¦‰, ν…ν”λ¦Ώ λ‚΄ λ¨λ“  μ±„λ„μ λ°μ΄ν„° μ •ν•©μ„± κ²€μ¦ ν›„μ—μ•Ό μ¤‘κ³„ G/W λ°μ†΅μ΄ μ§„ν–‰λ©λ‹λ‹¤.  
- μ¤λ¥κ°€ λ°μƒν• κ²½μ° λ°μ΄ν„°λ¥Ό μμ • ν›„ **μ¬λ°μ†΅**μ„ μ§„ν–‰ν•΄μ•Ό ν•©λ‹λ‹¤.

---

## π§Ύ μ”μ•½ μ •λ¦¬

| κµ¬λ¶„ | ν™•μΈ μ»¬λΌ | μ£Όμ” λ‚΄μ© |
|:------|:-----------|:----------|
| λ°μ†΅ μ„±κ³µ | `DONE_PRODUCT`, `DONE_CODE`, `DONE_CODE_DESC` | μ‹¤μ  μ„±κ³µ μ±„λ„, μ½”λ“, μ„¤λ… |
| μ΄μ „ μ‹¤ν¨ κ²½λ΅ | `DONE_FB_DETAIL` | μ΄μ „ μ‹¤ν¨ μ±„λ„ λ° μ‚¬μ  (JSON) |
| μ΄ν†µμ‚¬ | `DONE_TELCO` | μµμΆ… μμ‹ μμ μ΄λ™ν†µμ‹ μ‚¬ μ½”λ“ |
| μ—μ΄μ „νΈ/GW μ‹¤ν¨ | `DONE_CODE`, `DONE_CODE_DESC` | 90000, 21000~25000, 29000 μ½”λ“ μ°Έκ³  |

---

## π“© μ°Έκ³ 

- κ²°κ³Ό μ»¬λΌμ€ `UMS_MSG`μ—μ„ λ°μ†΅ ν›„ **μλ™ μ΄κ΄€λ λ΅κ·Έ ν…μ΄λΈ”(`UMS_LOG_YYYYMM`)**μ—μ„ μ΅°νν•©λ‹λ‹¤.  
- `DONE_FB_DETAIL`μ€ JSON λ°°μ—΄ ν•νƒμ΄λ©°, **μ‹¤ν¨ν• μ±„λ„μ μμ„μ™€ μ‚¬μ λ¥Ό λ¨λ‘ κΈ°λ΅**ν•©λ‹λ‹¤.  
- λ¨λ“  μ±„λ„μ λ°μ†΅ λ°μ΄ν„° μ •ν•©μ„± ν™•μΈ ν›„μ—λ§ λ°μ†΅μ΄ μ§„ν–‰λλ―€λ΅,  
  **λ°μ΄ν„° λ¶μΌμΉ λ°μƒ μ‹ μ΄κΈ° λ‹¨κ³„μ—μ„ μ‹¤ν¨ μ²λ¦¬λ©λ‹λ‹¤.**

---

β… **λ.**
